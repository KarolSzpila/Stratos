/*
 * FlightControlControler.cpp
 *
 *  Created on: 30.10.2017
 *      Author: Karol
 */

#include "FlightControlControler.h"

FlightControlControler::FlightControlControler(FlightControl& model,FlightCotrolView& view) : model(model), view(view)
{
	modelChanged = false;
}

void FlightControlControler::PassNewMessage(const ADS_BMessage& msg)
{
	std::string ICAO_Address = GetICAO_AddresAsString(msg);
	bool recordExist = false;
	AircraftRecord record;

	recordExist = model.FindAircraftByICAO_Address(ICAO_Address,record);


	if(recordExist == false)
	{
		record = AircraftRecord(ICAO_Address);
		model.AddRecord(record);
	}
}

std::string FlightControlControler::GetICAO_AddresAsString(const ADS_BMessage& msg)
{
	char buff[9];
	std::sprintf(buff,"%.2X%.2X%.2X",msg.aa1,msg.aa2,msg.aa3);
	return std::string(buff);
}

void FlightControlControler::UpdateTicksCount(uint32_t ticks)
{
	if(model.TickAllRecords(ticks); == true)
	{
		modelChanged = true;
	}
}
